<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.13.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="The journey of a thousand miles begins with one step">
<meta property="og:type" content="website">
<meta property="og:title" content="Weiru Han&#39;s blog">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="Weiru Han&#39;s blog">
<meta property="og:description" content="The journey of a thousand miles begins with one step">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Weiru Han">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/3/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Weiru Han's blog</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Weiru Han's blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Less is more</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Weiru Han</p>
  <div class="site-description" itemprop="description">The journey of a thousand miles begins with one step</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/29/Beta-distribution/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiru Han">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weiru Han's blog">
      <meta itemprop="description" content="The journey of a thousand miles begins with one step">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Weiru Han's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/29/Beta-distribution/" class="post-title-link" itemprop="url">Beta distribution</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-05-29 16:49:28" itemprop="dateCreated datePublished" datetime="2022-05-29T16:49:28-04:00">2022-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-11-07 00:39:59" itemprop="dateModified" datetime="2022-11-07T00:39:59-05:00">2022-11-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/statistics/" itemprop="url" rel="index"><span itemprop="name">statistics</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>A good interpretation of Beta distribution can be referred to a thread from <a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/47771/what-is-the-intuition-behind-beta-distribution?noredirect=1&amp;lq=1">What is the intuition behind beta distribution</a></p>
<blockquote>
<p>The short version is that the Beta distribution can be understood as representing a distribution <em>of probabilities</em>, that is, it represents all the possible values of a probability when we don't know what that probability is.</p>
</blockquote>
<p>For <span class="math inline">\(\theta\sim Beta(\alpha,\beta)\)</span> <span class="math display">\[
\begin{gather*}
p(\theta)=\frac{\theta^{\alpha-1}(1-\theta)^{\beta-1}}{B(\alpha,\beta)}\\
=\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}\theta^{\alpha-1}(1-\theta)^{\beta-1}\\
\theta\in[0,1]
\end{gather*}
\]</span> The expectation and variance of Beta distribution is <span class="math display">\[
\begin{gather*}
E(\theta)=\frac{\alpha}{\alpha+\beta}\\
var(\theta)=\frac{\alpha\beta}{(\alpha+\beta)^2(\alpha+\beta+1)}
\end{gather*}
\]</span> When <span class="math inline">\(\alpha=\beta=1\)</span>, Beta distribution is equivalent to the uniform distribution <span class="math display">\[
\begin{gather*}
p(\theta)=\frac{\Gamma(2)}{\Gamma(1)\Gamma(1)}\theta^0(1-\theta)^0\\
=\frac{1\Gamma(1)}{1*1}\\
=1\\
F_{\Theta}(x)=\int_0^x 1d\theta=x\in[0,1]\\
\Rightarrow \theta\sim U(0,1)
\end{gather*}
\]</span></p>
<h2 id="reference">Reference</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/47771/what-is-the-intuition-behind-beta-distribution?noredirect=1&amp;lq=1">What is the intution behind beta distribution?</a></li>
<li><a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/318541/uniform-vs-beta1-1-prior">Uniform vs Beta(1,1) prior</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/28/q-value/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiru Han">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weiru Han's blog">
      <meta itemprop="description" content="The journey of a thousand miles begins with one step">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Weiru Han's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/28/q-value/" class="post-title-link" itemprop="url">q-value</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-05-28 16:44:17" itemprop="dateCreated datePublished" datetime="2022-05-28T16:44:17-04:00">2022-05-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-11-07 00:39:59" itemprop="dateModified" datetime="2022-11-07T00:39:59-05:00">2022-11-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/statistics/" itemprop="url" rel="index"><span itemprop="name">statistics</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="q-value">Q value</h1>
<p>From <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Q-value_(statistics)">wikipedia</a>, q value is phrased as follows</p>
<blockquote>
<p>In <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Statistical_hypothesis_testing">statistical hypothesis testing</a>, specifically <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem">multiple hypothesis testing</a>, the <strong>q-value</strong> provides a means to control the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/False_discovery_rate#Related_error_rates">positive false discovery rate</a> (pFDR).<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Q-value_(statistics)#cite_note-:0-1">John D. 2003</a> Just as the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/P-value">p-value</a> gives the expected <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/False_positive_rate">false positive rate</a> obtained by rejecting the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Null_hypothesis">null hypothesis</a> for any result with an equal or smaller p-value, the q-value gives the expected pFDR obtained by rejecting the null hypothesis for any result with an equal or smaller q-value.</p>
</blockquote>
<p>From <a target="_blank" rel="noopener" href="https://www.pearson.com/us/higher-education/program/Tamhane-Statistics-and-Data-Analysis-From-Elementary-to-Intermediate/PGM227786.html">Statistics and Data analysis: From elementary to Intermediate</a>, we can find the explicit definition of <strong>p-value</strong></p>
<blockquote>
<p>Simply rejecting or not rejecting <span class="math inline">\(H_0\)</span> at a specified <span class="math inline">\(\alpha\)</span> does not fully convey the information in the data. It is more useful to report the <em>smallest</em> a-level at which the observed test result is significant. This smallest <span class="math inline">\(\alpha\)</span>-level is called the <strong>observed level of significance</strong> or the <strong>P-value.</strong> The smaller the <strong>P-value</strong>, the more significant is the test result. Once the <strong>P-value</strong> is computed, a test at any specified <span class="math inline">\(\alpha\)</span> can be conducted by rejecting <span class="math inline">\(H_0\)</span> if <strong>P-value</strong><span class="math inline">\(&lt;\alpha\)</span>. <code>An alternative definition of the <strong>P-value</strong> is that it is the probability under Null hypothesis of obtaining a test statistic at least as "extreme" as the observed value. </code></p>
</blockquote>
<p>We can provide an example to enhance the understanding of <strong>p-value</strong> and <strong>q-value</strong>. Assume we have <span class="math inline">\(1000\)</span> tests. Each test will produce a <strong>p-value</strong>. We can order these <strong>p-values</strong> from the smallest to the largest. A <strong>p-value</strong> of <span class="math inline">\(0.05\)</span> means <span class="math inline">\(5\%\)</span> of <strong>all tests</strong> which is 50 tests are expected to output false positive results. A <strong>q-value</strong> of <span class="math inline">\(0.05\)</span> means tests with <strong>q-value</strong> less than <span class="math inline">\(0.05\)</span> are all considered to be significant, and <span class="math inline">\(5\%\)</span> of these significant tests are expected to output false positive results.</p>
<p>One of the methods that adjust <strong>p-value</strong> to <strong>q-value</strong> is the <a href="%5B10.1111/j.2517-6161.1995.tb02031.x%5D(https://doi.org/10.1111%2Fj.2517-6161.1995.tb02031.x)">Benjamini-Hochberg method</a>, (short for <strong>BH</strong>). The <strong>BH-adjusted p-values</strong> are defined as <span class="math display">\[
p_{(i)}^{BH}=min\{\underset{j\geq i}{min}\{\frac{mp_{(j)}}{j}\},1\}
\]</span> The process is as follows.</p>
<blockquote>
<ol type="1">
<li>Order all <strong>p-values</strong> in an ascending sequence. Then multiply each <strong>p-value</strong> by the total number of test <span class="math inline">\(m\)</span> and divide by its rank order</li>
<li>For the first <strong>p-value</strong>, find the minimum value of <span class="math inline">\(\frac{mp_{(j)}}{j}\)</span>for <span class="math inline">\(j=1,2,\cdots,m\)</span>; compare with <span class="math inline">\(1\)</span>, assign <strong>q-value</strong> as <span class="math inline">\(1\)</span> if it is larger than <span class="math inline">\(1\)</span>. This value would be the smallest <strong>q-value</strong> among all tests; For the second <strong>p-value</strong>, find the minimum value of <span class="math inline">\(\frac{mp_{(j)}}{j}\)</span>for <span class="math inline">\(j=2,\cdots,m\)</span>, this <strong>q-value</strong> must be less than the first <strong>q-value</strong>. We begin this procedure until all <strong>p-values</strong> are adjusted to <strong>q-values</strong></li>
</ol>
</blockquote>
<p>We can write <strong>BH method</strong> using R code</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> BH <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>p.values<span class="punctuation">)</span></span><br><span class="line"><span class="operator">+</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="operator">+</span>   p <span class="operator">&lt;-</span> p.values</span><br><span class="line"><span class="operator">+</span>   lp <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>p<span class="punctuation">)</span></span><br><span class="line"><span class="operator">+</span>   i <span class="operator">&lt;-</span> lp<span class="operator">:</span><span class="number">1L</span></span><br><span class="line"><span class="operator">+</span>   <span class="comment"># key to the p.values (key1)</span></span><br><span class="line"><span class="operator">+</span>   o <span class="operator">&lt;-</span> order<span class="punctuation">(</span>p<span class="punctuation">,</span>decreasing <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">+</span>   <span class="comment"># key to the key1 (key2)</span></span><br><span class="line"><span class="operator">+</span>   ro <span class="operator">&lt;-</span> order<span class="punctuation">(</span>o<span class="punctuation">)</span></span><br><span class="line"><span class="operator">+</span>   pmin<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="built_in">cummin</span><span class="punctuation">(</span>lp<span class="operator">/</span>i <span class="operator">*</span> p<span class="punctuation">[</span>o<span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">[</span>ro<span class="punctuation">]</span></span><br><span class="line"><span class="operator">+</span> <span class="punctuation">&#125;</span></span><br><span class="line"><span class="operator">&gt;</span> BH<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.05</span><span class="punctuation">,</span><span class="number">0.02</span><span class="punctuation">,</span><span class="number">0.2</span><span class="punctuation">,</span><span class="number">0.4</span><span class="punctuation">,</span><span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.1250000</span> <span class="number">0.1000000</span> <span class="number">0.3333333</span> <span class="number">0.5000000</span> <span class="number">0.5000000</span></span><br></pre></td></tr></table></figure>
<p>We can visualize this process</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">p.value</th>
<th style="text-align: center;">0.05</th>
<th style="text-align: center;">0.02</th>
<th style="text-align: center;">0.2</th>
<th style="text-align: center;">0.4</th>
<th style="text-align: center;">0.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">p.value position (key1)</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">5</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\downarrow
\]</span></p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">p.value position(key1)</th>
<th style="text-align: center;">5</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">q.value</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">1/3</td>
<td style="text-align: center;">0.125</td>
<td style="text-align: center;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Position of key (key2)</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">5</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\downarrow
\]</span></p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">position of key (key2)</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">p.value position (key1)</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">p.value</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">0.2</td>
<td style="text-align: center;">0.4</td>
<td style="text-align: center;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">q.value</td>
<td style="text-align: center;">0.125</td>
<td style="text-align: center;">0.1</td>
<td style="text-align: center;">1/3</td>
<td style="text-align: center;">1/2</td>
<td style="text-align: center;">1/2</td>
</tr>
</tbody>
</table>
<h2 id="reference">Reference</h2>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Q-value_(statistics)">wikipedia</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://www.pearson.com/us/higher-education/program/Tamhane-Statistics-and-Data-Analysis-From-Elementary-to-Intermediate/PGM227786.html">Statistics and Data analysis: From elementary to Intermediate</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/238458/whats-the-formula-for-the-benjamini-hochberg-adjusted-p-value">what's the formula for the Benjamini-Hochberg adjusted p-value?</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://www.jstor.org/stable/2346101">Benjamini &amp; Hochberg (1995)</a></p></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/09/Density-of-transformed-random-variable/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiru Han">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weiru Han's blog">
      <meta itemprop="description" content="The journey of a thousand miles begins with one step">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Weiru Han's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/09/Density-of-transformed-random-variable/" class="post-title-link" itemprop="url">Density of transformed random variable</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-05-09 02:27:40" itemprop="dateCreated datePublished" datetime="2022-05-09T02:27:40-04:00">2022-05-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-11-07 00:39:59" itemprop="dateModified" datetime="2022-11-07T00:39:59-05:00">2022-11-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/statistics/" itemprop="url" rel="index"><span itemprop="name">statistics</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Suppose we are given the distribution of a <strong>continuous</strong> random variable <span class="math inline">\(X\)</span>. Let <span class="math inline">\(Y=\phi(X)\)</span>, where <span class="math inline">\(\phi\)</span> is an invertible (one-to-one) function. Let <span class="math inline">\(\psi=\phi^{-1}\)</span> so that <span class="math inline">\(X=\psi(Y)\)</span>. Furthermore,suppose <span class="math inline">\(\psi\)</span> is differentiable. Then the p.d.f. of <span class="math inline">\(Y\)</span> is <span class="math display">\[
\begin{gather}
g(y)=f(\psi(y))|\frac{dx}{dy}|\\
\text{where }x=\psi(y)
\end{gather}
\]</span> From the equation, we can easily observe that <span class="math inline">\(|\frac{dx}{dy}|\)</span> is the dispersion of <span class="math inline">\(Y\)</span> when random variable <span class="math inline">\(X\)</span> is transformed to random variable <span class="math inline">\(Y\)</span>. Thus one cannot simply replace <span class="math inline">\(X\)</span> with <span class="math inline">\(\psi(y)\)</span> to derive the density of <span class="math inline">\(Y\)</span> without considering the difference of dispersion between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p><strong>Proof:</strong></p>
<p>Let <span class="math inline">\(G(y)\)</span> represents the c.d.f. of <span class="math inline">\(Y\)</span>. first suppose <span class="math inline">\(\phi\)</span> is a strictly increasing function. Then <span class="math inline">\(\psi=\phi^{-1}\)</span> is also a strictly increasing function and <span class="math inline">\(d\psi(y)/dy&gt;0\)</span>. Therefore <span class="math display">\[
\begin{gather}\\
G(y)=P[Y\leq y]=P[\phi(X)\leq y]\\
=P(X\leq \phi^{-1}(y))=F(\psi(y))
\end{gather}
\]</span> Differentiating <span class="math inline">\(G(y)\)</span> by using the chain rule, it follows that <span class="math display">\[
\begin{gather}
g(y)=\frac{dG(y)}{dy}=\frac{dF(\psi(y))}{dy}\\
=f(\psi(y))\frac{d\psi(y)}{dy}=f(\psi(y))\frac{dx}{dy}
\end{gather}
\]</span> Next suppose <span class="math inline">\(\phi\)</span> is a strictly decreasing function. Then <span class="math inline">\(\psi=\phi^{-1}\)</span> is also a strictly decreasing function and <span class="math inline">\(d\psi(y)/dy&lt;0\)</span>. Therefore <span class="math display">\[
G(y)=P[Y\leq y] = P[\phi(X)\leq y]=P[X\geq\phi^{-1}(y)]=1-F(\psi(y))
\]</span> Differentiating <span class="math inline">\(G(y)\)</span> by using the chain rule, it follows that <span class="math display">\[
\begin{gather}
g(y)=\frac{dG(y)}{dy} = -\frac{dF(\psi(y))}{dy}\\
=-f(\psi(y))\frac{d\psi(y)}{dy}\\
=f(\psi(y))|\frac{dx}{dy}|
\end{gather}
\]</span></p>
<h2 id="example">Example</h2>
<p>Suppose <span class="math inline">\(Y=lnX\)</span>, where <span class="math inline">\(X\sim Beta(a,b)\)</span>.</p>
<ul>
<li>Then we have p.d.f. of <span class="math inline">\(X\)</span></li>
</ul>
<p><span class="math display">\[
\begin{gather}
f_X(x)=\frac{x^{a-1}(1-x)^{b-1}}{B(a,b)}\\
\text{where }B(a,b)=\frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)}\\
x\in[0,1]
\end{gather}
\]</span></p>
<p><span class="math display">\[
\begin{gather}
Y=\phi(X)=lnX\\
Y\in(-\infty,0]\\
X=\psi(Y)=e^Y\\
X\in[0,1]
\end{gather}
\]</span></p>
<ul>
<li>Then we have p.d.f. of <span class="math inline">\(Y\)</span></li>
</ul>
<p><span class="math display">\[
\begin{gather}
g_Y(y)=f_X(\psi(y))|\frac{dx}{dy}|\\
=\frac{e^{y(a-1)}(1-e^y)^{b-1}}{B(a,b)}e^y\ (\frac{dx}{dy}=\frac{de^y}{dy}=e^y)\\
=\frac{e^{ay}(1-e^y)^{b-1}}{B(a,b)}
\end{gather}
\]</span></p>
<ul>
<li>Next we derive the m.g.f. (moment generating function) of <span class="math inline">\(Y\)</span></li>
</ul>
<p><span class="math display">\[
\begin{gather}
M_Y(t)=E[e^{tY}]\\
=\int_{-\infty}^0e^{ty}g_Y(y)dy\\
=\int_{-\infty}^0\frac{e^{ay}(1-e^y)^{b-1}}{B(a,b)}e^{ty}dy\\
=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\int_{-\infty}^0(e^y)^{a+t}(1-e^y)^{b-1}dy\\
=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\int_0^1x^{a+t}(1-x)^{b-1}dlnx\ (e^y=e^{lnx}=x)\\
=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\int_0^1x^{a+t}(1-x)^{b-1}\frac{1}{x}dx\\(\frac{dy}{dx}=\frac{dlnx}{dx}=\frac{1}{x}\Rightarrow dlnx=\frac{1}{x}dx)\\
=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\int_0^1x^{a+t-1}(1-x)^{b-1}dx\\
=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}B(a+t,b)\int_0^1\frac{x^{a+t-1}(1-x)^{b-1}}{B(a+t,b)}dx\\
=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}B(a+t,b)\\
(\int_0^1\frac{x^{a+t-1}(1-x)^{b-1}}{B(a+t,b)}dx\text{ is the integration of distribution }Beta(a+t,b)\text{ which is 1})\\
=\frac{\Gamma(a+b)\Gamma(a+t)\Gamma(b)}{\Gamma(a)\Gamma(b)\Gamma(a+b+t)}\\
=\frac{\Gamma(a+b)\Gamma(a+t)}{\Gamma(a+b+t)\Gamma(a)}
\end{gather}
\]</span></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/25/Terminologies-in-collecting-data/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiru Han">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weiru Han's blog">
      <meta itemprop="description" content="The journey of a thousand miles begins with one step">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Weiru Han's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/25/Terminologies-in-collecting-data/" class="post-title-link" itemprop="url">Terminologies in collecting data</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-04-25 15:44:52" itemprop="dateCreated datePublished" datetime="2022-04-25T15:44:52-04:00">2022-04-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-11-07 00:39:59" itemprop="dateModified" datetime="2022-11-07T00:39:59-05:00">2022-11-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/statistics/" itemprop="url" rel="index"><span itemprop="name">statistics</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="types-of-statistical-studies">Types of Statistical studies</h2>
<ul>
<li><p>Study with different purposes</p>
<ul>
<li><p>Comparative (analytical) study</p>
<p>A study whose purpose is to compare two or more alternative methods or groups distinguished by some attribute is called a comparative (analytical) study</p></li>
<li><p>Noncomparative (descriptive) study</p>
<p>A study whose purpose is to learn about the characteristics of a group, but no necessarily to make comparasions, is called a noncomparative (descriptive) study</p></li>
</ul></li>
<li><p>Study with or without intervention</p>
<ul>
<li><p>Observational study</p>
<p>The researcher is a passive observer who documents the process</p></li>
<li><p>Experimental study</p>
<p>The researcher actively intervenes to control the study conditions and records the response</p></li>
</ul>
<blockquote>
<p>Remark: Both study types can be either comparative or noncomparative</p>
</blockquote></li>
</ul>
<h2 id="confounding-variable">Confounding variable</h2>
<p>If the effects of predictor variables cannot be separated from the effects of the uncontrolled variables, those uncontrolled variables are called confounding variables. A variable must meet two conditions to be a confounder:</p>
<ul>
<li>It must be correlatedd with the independent variable. This <strong>may be</strong> a causal relationship, but it does not have to be.</li>
<li>It <strong>must be</strong> causally related to the dependent variable</li>
</ul>
<p>Sometimes the presence of these variables is not recognized after the fact, in which case they are referred to as <strong>lurking variables</strong></p>
<pre><code class="highlight mermaid">graph TD
A[Confounding variable]-.-&gt;B[predictor variable];
B --&gt;C[response variable];
A --&gt;C;</code></pre>
<p><a target="_blank" rel="noopener" href="https://www.scribbr.com/methodology/confounding-variables/">See more info</a></p>
<h2 id="comparative-study">Comparative study</h2>
<blockquote>
<p>The goal of the simplest and most common comparative studies is to evaluate how a "change" from a <code>"baseline"</code> or <code>"normal"</code> condition affects a response variable.</p>
</blockquote>
<ul>
<li><p>The changed condition is called a <strong>treatment</strong> or an <strong>intervention</strong> and the normal condition is called a <strong>control</strong></p></li>
<li><p>The <strong>treatment</strong> and <strong>control</strong> group should be similar in all other respects excepty for the changed condition to provide a valid comparison</p></li>
</ul>
<h2 id="observational-study">Observational study</h2>
<ul>
<li>A <strong>sample survey</strong> provides a snapshot of the population based on a sample observed at a point <code>in time</code></li>
<li>A <strong>prospective study</strong> follows a sample <code>forward in time</code></li>
<li>A <strong>retrospective study</strong> follows a sample <code>backward in time</code></li>
</ul>
<h3 id="sample-survey">Sample survey</h3>
<ul>
<li>A numerical characteristic of a <strong>population</strong> defined for a specific variable is called a <strong>parameter</strong></li>
<li>A numerical function of the <code>sample data</code>, called a <strong>statistic</strong>, is used to estimate the unknown <strong>population parameter</strong></li>
<li>It is possible to list all units in a <strong>finite population</strong>; a list of all units in a finite population is called a <strong>sampling frame</strong>;</li>
<li>It is impossible to list all units of an <strong>infinite population</strong> as there is no upper limit on the number of units in a population</li>
<li>The population of interest is called the <strong>target population</strong>; sometimes the target population is difficult to study, so sampling is done using another easily accessible population, called the <strong>sampled population</strong></li>
<li>The deviation between a sample estimate and the true parameter value is called the <strong>sampling error</strong>; <strong>nonsampling error</strong> often cause <strong>bias</strong>, which is a <code>systematic deviation</code> between the sample estimate and the population parameter; <strong>bias</strong> is a more serious problem than sampling errors because it doesn't disappear by increasing the sample size. For example, <strong>measurement bias</strong> affects all measurements. <strong>Nonsampling error</strong> includes other types such as <strong>self-selection bias</strong> and <strong>response bias</strong></li>
</ul>
<h2 id="basic-sampling-designs">Basic sampling designs</h2>
<ul>
<li><p><strong>Simple random sample(SRS)</strong></p>
<p>Draw a sample of size <span class="math inline">\(n\)</span> from a population of size <span class="math inline">\(N\)</span> <strong>Without replacement</strong></p></li>
<li><p><strong>Stratified Random sampling</strong></p>
<p>Divide a population into homogeneous subpopulations and draw <strong>SRS</strong> from each one</p></li>
<li><p><strong>Multistage cluster sampling</strong></p>
<p>Draw SRS layer by layer from the top to the bottom</p></li>
<li><p><strong>Systematic sampling</strong></p>
<p>A <code>1-in-k</code> <strong>systematic sampling</strong> consists of selecting one unit at random from the first <span class="math inline">\(k\)</span> Unit and selecting every <span class="math inline">\(kth\)</span> Unit thereafter; mainly useful for cases such as assembly line or cars entering a toll booth on a highway</p></li>
</ul>
<h2 id="experimental-studies">Experimental studies</h2>
<ul>
<li><strong>Treatment factors</strong> are controlled in an experiment, effects of the response variable are of primary interest</li>
<li><strong>Nuisance factors</strong>, or <strong>noise factors</strong> are all the other factors that might affect the response variable</li>
<li>The different possible values of a factor are called <strong>levels</strong>, and each treatment is a particular combination of the levels of different treatment factors</li>
<li>Subjects or items receiving treatments are called <strong>experimental units</strong>; all experimental units receiving the same treatment form a <strong>treatment group</strong></li>
<li><strong>A run</strong> is an observation made on an experimental unit after a particular treatment condition; a <strong>replicate</strong> is another independent run carried out under a particular identical conditions; <strong>repeat measurements</strong> of the same response is not replicate</li>
</ul>
<h3 id="strategies-to-reduce-experimental-error-variation">Strategies to reduce experimental error variation</h3>
<blockquote>
<p>Main components of experimental error:</p>
<ul>
<li><p>Systematic error</p>
<p>Caused by difference between experimental units; the nuisance factors on which the experimental units differ are said to <strong>confound</strong> or <strong>bias</strong> the treatment comparisons</p></li>
<li><p>Random error</p>
<p>Caused by the inherent variability in the response of similar experimental units <code>given the same treatment</code></p></li>
<li><p>Measurement error</p>
<p>Caused by imprecise measurement instruments</p></li>
</ul>
</blockquote>
<ul>
<li><p><code>Strategies</code> to reduce the <code>systematic error</code> with respect to type of <code>nuisance factor</code></p>
<blockquote>
<ul>
<li>Blocking: nuisance factor is <b>controllable</b></li>
<li>Regression Analysis: nuisance factors cannot be used as <b>blocking factor</b> because they are <b>not controllable</b>; such nuisance factors are called <b>covariates</b>. A <b>covariate</b> should be measured before the treatment are applied to experimental units because it could also be affected by the treatment</li>
<li>Randomization: in terms of additional known or unknown nuisance factors, the experimental units may <b>well differ</b> on these factors, thus biasing the results. Randomization doesn't imply experimental units are equal for each treatment, but that no one treatment is favored</li>
</ul>
<p><code>Note:</code> A covariates can be an independent variable (i.e. of direct interest) or it can be unwanted, confounding variable. Adding a covariate to a model can increase the accuracy of the results <a target="_blank" rel="noopener" href="https://www.statisticshowto.com/covariate/">See more info</a></p>
<p><code>In summary</code>: Block over those nuisance factors that can be easily controlled, randomize over the rest</p>
</blockquote></li>
<li><p>Strategy to reduce the <code>random error</code></p>
<blockquote>
<p>Replicating the experimental runs; making multiple independent runs under identical treatment conditions</p>
</blockquote></li>
<li><p>Strategy to reduce the measurement error</p>
<blockquote>
<p>Repeat measurements, including having different subjects make the measurements;</p>
<p>Variation within each group of measurements can be used to estimate random and measurement errors.</p>
</blockquote></li>
</ul>
<h3 id="basic-experimental-designs">Basic experimental designs</h3>
<ul>
<li><p>Completely randomized design (CRD)</p>
<blockquote>
<p>All experimental units are assigned at random to the treatment</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Batch 1</th>
<th style="text-align: center;">Batch 2</th>
<th style="text-align: center;">Batch 3</th>
<th style="text-align: center;">Batch 4</th>
<th style="text-align: center;">Batch 5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;">B</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">D</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">C</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">A</td>
</tr>
</tbody>
</table>
<p><em>Randomly assign <span class="math inline">\(20\)</span> samples to the <span class="math inline">\(4\)</span> treatments <span class="math inline">\(ABCD\)</span> without considering the batchs they are from</em></p></li>
<li><p>Randomized block design (RBD)</p>
<blockquote>
<p>Forming blocks of units which are similar (in terms of chosen blocking factors)</p>
<p>Two special cases:</p>
<ul>
<li>Matched pairs design: Match subjects on the nuisance factors (controllable)</li>
<li>Cross-over design: the order in which the methods are administered may introduce bias due to the learning effect</li>
</ul>
</blockquote>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Batch 1</th>
<th style="text-align: center;">Batch 2</th>
<th style="text-align: center;">Batch 3</th>
<th style="text-align: center;">Batch 4</th>
<th style="text-align: center;">Batch 5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;">B</td>
</tr>
<tr class="even">
<td style="text-align: center;">C</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">C</td>
</tr>
<tr class="odd">
<td style="text-align: center;">B</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">A</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">D</td>
</tr>
</tbody>
</table>
<p><em>Randomly assign <span class="math inline">\(4\)</span> treatments to the experiments within each block</em></p></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/21/Relationship-between-R-square-and-correlation-coefficient/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiru Han">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weiru Han's blog">
      <meta itemprop="description" content="The journey of a thousand miles begins with one step">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Weiru Han's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/21/Relationship-between-R-square-and-correlation-coefficient/" class="post-title-link" itemprop="url">Relationship between R-square and correlation coefficient</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-04-21 23:15:16" itemprop="dateCreated datePublished" datetime="2022-04-21T23:15:16-04:00">2022-04-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-11-11 02:44:30" itemprop="dateModified" datetime="2022-11-11T02:44:30-05:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/statistics/" itemprop="url" rel="index"><span itemprop="name">statistics</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="the-coefficient-of-determination-of-r2">The coefficient of determination of <span class="math inline">\(R^2\)</span></h1>
<p>To begin with, we need to mention several terms that we must define</p>
<ul>
<li><p><strong>SST</strong>: sum of squares total, as the squared difference between the observed dependent variable and its mean <span class="math display">\[
\sum(y_i-\overline{y})^2
\]</span></p></li>
<li><p><strong>SSR/ESS</strong>: sum of squares due to regression or explained sum of squares, as the sum of the differences between the predicted value and the mean of the dependent variable <span class="math display">\[
\sum(\hat{y}_i-\overline{y})^2=\sum(\hat{y}_i-\overline{\hat{y}})^2
\]</span></p></li>
<li><p><strong>SSE/RSS</strong>: sum of square error or residual sum of squares, as the difference between the observed value and the predicted value, and as the <em>unexplained variability</em> <span class="math display">\[
\sum(y_i-\hat{y}_i)^2=\sum e_i^2
\]</span></p></li>
</ul>
<p>The coefficient of determination of <span class="math inline">\(R^2\)</span> shows how much of the variation of the dependent variable <code>Var(y)</code> can be explained by the model; In <strong>OLS</strong> estimate, <span class="math inline">\(R^2\)</span> can also be calculated as the ratio of Explained sum of square (ESS) to total sum squared(TSS) <span class="math display">\[
R^2=\frac{ESS}{SST}=1-\frac{SSE}{SST}=1-\frac{\sum e_i^2}{\sum(y_i-\overline{y})^2}
\]</span></p>
<h2 id="formulate-r2">Formulate <span class="math inline">\(R^2\)</span></h2>
<p>Suppose <span class="math inline">\(y_i=\hat{y}_i+e_i\)</span> <span class="math display">\[
\begin{gather}
Var(y)=Var(y)+Var(e)+2Cov(\hat{y},e)\\
=Var(\hat{y})+Var(e)\ (Cov(\hat{y},e)=0)\\
\Rightarrow\sum(y_i-\overline{y})^2=\sum(\hat{y}_i-\overline{\hat{y}})^2+\sum(e_i-\overline{e})^2\\
=\sum(\hat{y}_i-\overline{\hat{y}})^2+\sum e_i^2\ (\overline{e}=0)\\
=\sum(\hat{y}_i-\overline{y})^2+\sum e_i^2
\end{gather}
\]</span></p>
<h2 id="relationship-between-r2-and-pearson-correlation-coefficient">Relationship between <span class="math inline">\(R^2\)</span> and Pearson correlation coefficient</h2>
<p><span class="math display">\[
\begin{gather}
r^2_{y,\hat{y}}=(\frac{Cov(y,\hat{y})}{\sqrt{Var(y)Var(\hat{y})}})^2
=\frac{Cov(y,\hat{y})Cov(y,\hat{y})}{Var(y)Var(\hat{y})}\\
=\frac{Cov(\hat{y}+e,\hat{y})^2}{Var(y)Var(\hat{y})}
=\frac{Cov(\hat{y},\hat{y})^2}{Var(y)Var(\hat{y})}\ (Cov(\hat{y},e)=0)\\
=\frac{Var(\hat{y})}{Var(y)}
=\frac{\sum(\hat{y}_i-\overline{\hat{y}})^2}{\sum(y_i-\overline{y})^2}\\
=\frac{SSR}{SST}\\
=R^2
\end{gather}
\]</span></p>
<blockquote>
<p>Conclusion: <span class="math inline">\(R^2\)</span> is equal to the squared Pearson correlation coefficient between observed response variable <span class="math inline">\(y\)</span> and predicted response variable <span class="math inline">\(\hat{y}\)</span></p>
</blockquote>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> iris_model <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Petal.Width<span class="operator">~</span>Sepal.Length<span class="operator">+</span>Sepal.Width<span class="operator">+</span>Petal.Length<span class="punctuation">,</span>data <span class="operator">=</span> iris<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>iris_model<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> Petal.Width <span class="operator">~</span> Sepal.Length <span class="operator">+</span> Sepal.Width <span class="operator">+</span> Petal.Length<span class="punctuation">,</span> </span><br><span class="line">    data <span class="operator">=</span> iris<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">     Min       <span class="number">1</span>Q   Median       <span class="number">3</span>Q      Max </span><br><span class="line"><span class="operator">-</span><span class="number">0.60959</span> <span class="operator">-</span><span class="number">0.10134</span> <span class="operator">-</span><span class="number">0.01089</span>  <span class="number">0.09825</span>  <span class="number">0.60685</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="operator">-</span><span class="number">0.24031</span>    <span class="number">0.17837</span>  <span class="operator">-</span><span class="number">1.347</span>     <span class="number">0.18</span>    </span><br><span class="line">Sepal.Length <span class="operator">-</span><span class="number">0.20727</span>    <span class="number">0.04751</span>  <span class="operator">-</span><span class="number">4.363</span> <span class="number">2.41e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Sepal.Width   <span class="number">0.22283</span>    <span class="number">0.04894</span>   <span class="number">4.553</span> <span class="number">1.10e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Petal.Length  <span class="number">0.52408</span>    <span class="number">0.02449</span>  <span class="number">21.399</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.192</span> on <span class="number">146</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9379</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9366</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">734.4</span> on <span class="number">3</span> and <span class="number">146</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="punctuation">(</span>cor<span class="punctuation">(</span>iris_model<span class="operator">$</span>fitted.values<span class="punctuation">,</span>iris<span class="operator">$</span>Petal.Width<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">^</span><span class="number">2</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.9378503</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Particularly, for simple linear regression, the coefficient of determination also equals the square of the sample correlation coefficient <span class="math inline">\(r_{xy}\)</span></p>
</blockquote>
<p>Assume <span class="math inline">\(y_i=\beta_0+\beta_1x_i\)</span>, then the best linear unbiased estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are <span class="math display">\[
\begin{gather*}
\hat{\beta_0}=\bar{y}-\hat{\beta_1}\bar{x}\\
\hat{\beta_1}=\frac{S_{xy}}{S_{xx}}
\end{gather*}
\]</span> where <span class="math display">\[
\begin{gather*}
S_{xy}=\sum_{i=1}^n(x_i-\bar{x})(y_i-\bar{y})\\
S_{xx}=\sum_{i=1}^n(x_i-\bar{x})^2\\
S_{yy}=\sum_{i=1}^n(y_i-\bar{y})^2
\end{gather*}
\]</span> Then we could easily obtain the relationship between <span class="math inline">\(R^2\)</span> and the <span class="math inline">\(r_{xy}\)</span> as <span class="math display">\[
\begin{gather*}
R^2 = \frac{ESS}{SST}=\frac{\hat{\beta_1}^2S_{xx}}{S_{yy}}\\
=(\frac{S_{xy}}{S_xS_y})^2\\
=r^2_{xy}
\end{gather*}
\]</span> We could also test this by running R code</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> model <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Petal.Width <span class="operator">~</span> Sepal.Length<span class="punctuation">,</span>data <span class="operator">=</span> iris<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>model<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> Petal.Width <span class="operator">~</span> Sepal.Length<span class="punctuation">,</span> data <span class="operator">=</span> iris<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">     Min       <span class="number">1</span>Q   Median       <span class="number">3</span>Q      Max </span><br><span class="line"><span class="operator">-</span><span class="number">0.96671</span> <span class="operator">-</span><span class="number">0.35936</span> <span class="operator">-</span><span class="number">0.01787</span>  <span class="number">0.28388</span>  <span class="number">1.23329</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="operator">-</span><span class="number">3.20022</span>    <span class="number">0.25689</span>  <span class="operator">-</span><span class="number">12.46</span>   <span class="operator">&lt;</span><span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Sepal.Length  <span class="number">0.75292</span>    <span class="number">0.04353</span>   <span class="number">17.30</span>   <span class="operator">&lt;</span><span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.44</span> on <span class="number">148</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.669</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.6668</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">299.2</span> on <span class="number">1</span> and <span class="number">148</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> cor<span class="punctuation">(</span>model<span class="operator">$</span>fitted.values<span class="punctuation">,</span>iris<span class="operator">$</span>Petal.Width<span class="punctuation">)</span><span class="operator">^</span><span class="number">2</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.6690277</span></span><br><span class="line"><span class="operator">&gt;</span> cor<span class="punctuation">(</span>iris<span class="operator">$</span>Petal.Width<span class="punctuation">,</span>iris<span class="operator">$</span>Sepal.Length<span class="punctuation">)</span><span class="operator">^</span><span class="number">2</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.6690277</span></span><br></pre></td></tr></table></figure>
<h2 id="reference">Reference</h2>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://365datascience.com/tutorials/statistics-tutorials/sum-squares/">Sum of squares Total, Sum of Squares Regression and Sum of Squares Error</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://economictheoryblog.com/2014/11/05/the-coefficient-of-determination-latex-r2/">The coefficient of determination of R2</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://economictheoryblog.com/2014/11/05/proof/">Relationship between coefficient of determination and squared pearson correlation coefficient</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/187734/relationship-between-r2-and-correlation-coefficient">Relationship between R2 and correlation coefficient</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/83347/relationship-between-r2-and-correlation-coefficient">Relationship between rsquare and correlation coefficient</a></p></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/21/Linear%20regression/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiru Han">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weiru Han's blog">
      <meta itemprop="description" content="The journey of a thousand miles begins with one step">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Weiru Han's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/21/Linear%20regression/" class="post-title-link" itemprop="url">Linear regression Part</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-04-21 21:58:23" itemprop="dateCreated datePublished" datetime="2022-04-21T21:58:23-04:00">2022-04-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-11-07 00:39:59" itemprop="dateModified" datetime="2022-11-07T00:39:59-05:00">2022-11-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/statistics/" itemprop="url" rel="index"><span itemprop="name">statistics</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="prove-mean-of-predicted-values-in-ols-regression-is-equal-to-the-mean-of-original-values">Prove mean of predicted values in OLS regression is equal to the mean of original values</h1>
<p>In <strong>OLS</strong> estimation, we can summarize response <span class="math inline">\(y\)</span> as <span class="math display">\[
y_i=\hat{y}_i+e_i
\]</span> where residual <span class="math inline">\(e_i\)</span> is assumed to follow a normal distribution <span class="math inline">\(N(0,\sigma^2)\)</span> <span class="math display">\[
\sum e_i=\overline{e}=0
\]</span> thereby, we have <span class="math display">\[
\sum_{i=1}^ny_i=\sum_{i=1}^n(\hat{y}_i+e_i)\\
=\sum_{i=1}^n\hat{y}_i
\]</span></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> iris_model <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Petal.Width<span class="operator">~</span>Sepal.Length<span class="operator">+</span>Sepal.Width<span class="operator">+</span>Petal.Length<span class="punctuation">,</span>data <span class="operator">=</span> iris<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>iris_model<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> Petal.Width <span class="operator">~</span> Sepal.Length <span class="operator">+</span> Sepal.Width <span class="operator">+</span> Petal.Length<span class="punctuation">,</span> </span><br><span class="line">    data <span class="operator">=</span> iris<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">     Min       <span class="number">1</span>Q   Median       <span class="number">3</span>Q      Max </span><br><span class="line"><span class="operator">-</span><span class="number">0.60959</span> <span class="operator">-</span><span class="number">0.10134</span> <span class="operator">-</span><span class="number">0.01089</span>  <span class="number">0.09825</span>  <span class="number">0.60685</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="operator">-</span><span class="number">0.24031</span>    <span class="number">0.17837</span>  <span class="operator">-</span><span class="number">1.347</span>     <span class="number">0.18</span>    </span><br><span class="line">Sepal.Length <span class="operator">-</span><span class="number">0.20727</span>    <span class="number">0.04751</span>  <span class="operator">-</span><span class="number">4.363</span> <span class="number">2.41e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Sepal.Width   <span class="number">0.22283</span>    <span class="number">0.04894</span>   <span class="number">4.553</span> <span class="number">1.10e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Petal.Length  <span class="number">0.52408</span>    <span class="number">0.02449</span>  <span class="number">21.399</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.192</span> on <span class="number">146</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9379</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9366</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">734.4</span> on <span class="number">3</span> and <span class="number">146</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> mean<span class="punctuation">(</span>iris_model<span class="operator">$</span>fitted.values<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1.199333</span></span><br><span class="line"><span class="operator">&gt;</span> mean<span class="punctuation">(</span>iris<span class="operator">$</span>Petal.Width<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1.199333</span></span><br></pre></td></tr></table></figure>
<h2 id="related-qa">Related Q&amp;A</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/469212/proof-that-the-mean-of-predicted-values-in-ols-regression-is-equal-to-the-mean-o">Proof that the mean of predicted values in OLS regression is equal to the mean of original values?</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/21/Assumption-of-linear-regression/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiru Han">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weiru Han's blog">
      <meta itemprop="description" content="The journey of a thousand miles begins with one step">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Weiru Han's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/21/Assumption-of-linear-regression/" class="post-title-link" itemprop="url">Assumption of linear regression</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-04-21 16:46:09" itemprop="dateCreated datePublished" datetime="2022-04-21T16:46:09-04:00">2022-04-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-11-11 03:28:01" itemprop="dateModified" datetime="2022-11-11T03:28:01-05:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/statistics/" itemprop="url" rel="index"><span itemprop="name">statistics</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>The model is called “linear” not because it is linear in <span class="math inline">\(x\)</span>, but rather because it is <strong>linear in the parameters</strong>.</p>
<blockquote>
<p>The following are the examples of linear models:</p>
</blockquote>
<p><span class="math display">\[
\begin{gather*}
y =\beta_0+\beta_1x_1+\beta_2x_2+\epsilon\\
y =\beta_0+\beta_1x_1+\beta_2x_2^2+\epsilon\\
y =\beta_0+\beta_1x_1+\beta_2x_2+\beta_3x_1^2+\beta_4x_2^2+\beta_5x_1x_2+\epsilon
\end{gather*}
\]</span></p>
<p>A model that can be transformed so that it becomes linear in its unknown parameters is called <strong>intrinsically linear</strong>; Otherwise it is called a <strong>nonlinear model</strong></p>
<blockquote>
<p>The following are nonlinear models</p>
</blockquote>
<p><span class="math display">\[
\begin{gather*}
y =\beta_0+\beta_1x_1+\beta_2x_2^{\beta_3}+\epsilon\\
y = \alpha_0z_1^{\alpha_1}z_2^{\alpha_2}\eta
\end{gather*}
\]</span></p>
<blockquote>
<p>The following are some nonlinear models that can be made linear by transformation</p>
</blockquote>
<p><span class="math display">\[
\begin{gather*}
log \ y=log\alpha_0+\alpha_1logz_1+\alpha_2logz_2+log\eta\\
\Rightarrow y*=\beta_0+\beta_1x_1+\beta_2x_2+\epsilon
\end{gather*}
\]</span></p>
<p>There are four key assumptions for <strong>Simple Linear regression</strong></p>
<blockquote>
<ul>
<li>Linear relationship between dependent variable and independent variable</li>
<li>The variance of the residuals is constant (constant variance errors, homoscedasticity)</li>
<li>Independence of observation (no autocorrelation). Simply put, the model assumes that the values of residuals are independent</li>
<li>Normally distributed errors</li>
</ul>
</blockquote>
<p>In addition to the four assumptions listed above, there is one more for <strong>Multiple Linear regression.</strong></p>
<blockquote>
<ul>
<li>The data should not show multicollinearity.</li>
</ul>
</blockquote>
<p>There is an interesting post about Multicollinearity that I'd like to mention here.</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.researchgate.net/post/Is_it_necessary_to_correct_collinearity_when_square_terms_are_in_a_model">Is it necessary to correct collinearity when square terms are in a model?</a></p>
<ul>
<li>Question: I had a regression model where one of the explanatory variable is "age". I added a "age-squared" variable since the distribution of age was in a quadratic form. It is obvious that the 'age' and 'age-squared' variables will be highly correlated. In that case, is it really necessary to deal the collinearity problem in the model?</li>
</ul>
</blockquote>
<p>Several answers are great:</p>
<blockquote>
<ul>
<li>Multicollinearity is NOT a problem in your case. Multicollinearity has to be checked and problems have to be solved when you want to estimate the independent effect of two variables which happen to be correlated by chance. This is NOT your problem with your age and age-squared variables since you should never be interested in evaluating the effect of changing age without changing agesquared. So do not care about multicollinearity between one variable and a second variable which is a deterministic non linear function of the first one. Except in the case of perfect multocillinearity, which would be the case if you had only two different values for your age variable.</li>
<li>Age and age squared are correlated. However, one is not a linear transformation of the other by definition.</li>
<li>Another possibility is to run a regression between Age and Age2 to see that the R2 is close to zero. This indicates, as mentioned before by other colleagues, that collinearity is very low and can be overlooked from a econometric perspective.</li>
</ul>
</blockquote>
<h1 id="reference">Reference</h1>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/16381/what-is-a-complete-list-of-the-usual-assumptions-for-linear-regression">What is a complete list of the usual assumptions for linear regression?</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://www.researchgate.net/post/Is_it_necessary_to_correct_collinearity_when_square_terms_are_in_a_model">Is it necessary to correct collinearity when square terms are in a model?</a></p></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/21/Principal-component-analysis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiru Han">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weiru Han's blog">
      <meta itemprop="description" content="The journey of a thousand miles begins with one step">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Weiru Han's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/21/Principal-component-analysis/" class="post-title-link" itemprop="url">Principal component analysis</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-02-21 03:04:30" itemprop="dateCreated datePublished" datetime="2022-02-21T03:04:30-05:00">2022-02-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-11-07 00:39:59" itemprop="dateModified" datetime="2022-11-07T00:39:59-05:00">2022-11-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/PCA/" itemprop="url" rel="index"><span itemprop="name">PCA</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="principal-component-analysis">Principal Component analysis</h1>
<h2 id="pca-deduction-using-spectral-decomposition">PCA deduction using Spectral decomposition</h2>
<p>Suppose we have a random vector <span class="math display">\[
\begin{gather}
X = \begin{pmatrix}X_1\\X_2\\ \vdots\\\ X_p\end{pmatrix}\\
var(X) = \Sigma=\begin{bmatrix}\sigma_1^2 &amp; \sigma_{21}^2&amp; \cdots &amp; \sigma_{1p}^2\\
\sigma_{21}^2&amp; \sigma_{22}^2 &amp; \cdots &amp; \sigma_{2p}^2\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\sigma_{p1}^2&amp;\sigma_{p2}^2&amp; \cdots &amp; \sigma_{p}^2
\end{bmatrix}\\
\end{gather}
\]</span> We need to augment the spread between the data, so we need to consider linear combination <span class="math display">\[
Y_i = e_{11}X_1+e_{12}X_2+\cdots+e_{1p}X_p=\mathbf{e}_i^TX
\]</span> and maximize the variance of linear combination <span class="math display">\[
\begin{gather}
var(Y_i)=E[(\mathbf{e}_i^TX-E(\mathbf{e}_i^TX))^2]\\
E[(\mathbf{e}_i^TX-E(\mathbf{e}_i^TX))^T(\mathbf{e}_i^TX-E(\mathbf{e}_i^TX))]\\
=E[(\mathbf{e}_i^TX-E(\mathbf{e}_i^TX))(\mathbf{e}_i^TX-E(\mathbf{e}_i^TX))^T](\text{variance is a scalar})\\
=E[\mathbf{e}_i^TXX^T\mathbf{e}_i-\mathbf{e}_i^TEXEX^T\mathbf{e}_i]\\
=E[\mathbf{e}_i^T(XX^T)\mathbf{e}_i]\\
=\mathbf{e}_i^T[E(XX^T)-E(X)E(X^T)]\mathbf{e}_i\\
=\mathbf{e}_i^T\Sigma \mathbf{e}_i
\end{gather}
\]</span> Since <span class="math inline">\(\Sigma \mathbf{e}_i=\lambda_i\mathbf{e}_i\)</span> in spectral decomposition <span class="math display">\[
var(Y_i)=e_i^T\lambda_ie_i=\lambda_ie_i^Te_i=\lambda_i
\]</span></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/29/hexo_tutorial/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiru Han">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weiru Han's blog">
      <meta itemprop="description" content="The journey of a thousand miles begins with one step">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Weiru Han's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/29/hexo_tutorial/" class="post-title-link" itemprop="url">Basic command of hexo</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-29 22:36:50" itemprop="dateCreated datePublished" datetime="2021-11-29T22:36:50-05:00">2021-11-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-11-08 13:56:13" itemprop="dateModified" datetime="2022-11-08T13:56:13-05:00">2022-11-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/hexo/" itemprop="url" rel="index"><span itemprop="name">hexo</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="quick-start">Quick Start</h2>
<h3 id="create-a-new-post">Create a new post</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="run-server">Run server</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="generate-static-files">Generate static files</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="deploy-to-remote-sites">Deploy to remote sites</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
<h2 id="reference">Reference</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://theme-next.js.org/">Configure Hexo Next page from scratch</a></li>
<li><a target="_blank" rel="noopener" href="https://clarkchen.com/Hexo/Hexo%E4%B8%AD%E6%8F%92%E5%85%A5mermaid-diagrams/">Insert mermaid</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/29/Levy-process/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiru Han">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weiru Han's blog">
      <meta itemprop="description" content="The journey of a thousand miles begins with one step">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Weiru Han's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/29/Levy-process/" class="post-title-link" itemprop="url">Levy process</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-29 01:19:34" itemprop="dateCreated datePublished" datetime="2021-11-29T01:19:34-05:00">2021-11-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-11-07 00:39:59" itemprop="dateModified" datetime="2022-11-07T00:39:59-05:00">2022-11-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/time-series-analysis/" itemprop="url" rel="index"><span itemprop="name">time series analysis</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="definition-of-levy-process">Definition of Levy process</h1>
<p>A <b>Levy process</b>, <span class="math inline">\(\{L(t),t\in \mathbb{R}\}\)</span> is a process with the following <span class="math inline">\(4\)</span> properties:</p>
<ol type="i">
<li><p><span class="math inline">\(L(0)=0\)</span></p></li>
<li><p><span class="math inline">\(L(t)-L(s)\)</span> has the same distribution as <span class="math inline">\(L(t-s)\)</span> for <span class="math inline">\(\forall\ s,t\)</span> such that <span class="math inline">\(s\leq t\)</span></p></li>
<li><p>If <span class="math inline">\((s,t)\)</span> and <span class="math inline">\((u,v)\)</span> are disjoint intervals then <span class="math inline">\(L(t)-L(s)\)</span> and <span class="math inline">\(L(v)-L(u)\)</span> are independent</p></li>
<li><p><span class="math inline">\(\{L(t)\}\)</span> is continuous in probability, that is, for <span class="math inline">\(\forall\ \epsilon&gt;0\)</span> and for <span class="math inline">\(\forall\ t\in \mathbb{R}\)</span> <span class="math display">\[
\underset{s\rightarrow t}{lim}P(\left|L(t)-L(s)\right|&gt;\epsilon)=0
\]</span></p></li>
</ol>
<h2 id="brownian-motion">Brownian motion</h2>
<p>A well-known example of the levy process is the <strong>Brownian Motion</strong> <span class="math display">\[
\begin{gather}
L(t)\sim N(\mu t,\sigma^2t)\\
t\geq0,\ \mu\in \mathbb{R}\ and\ \sigma&gt;0
\end{gather}
\]</span> To show that it satisfies property (ii) of <strong>Levy process</strong>, we can calculate the corresponding expectation and variance <span class="math display">\[
\begin{gather}
E[L(t)-L(s)]\\
=E[L(t)]-E[L(s)]\\
=\mu(t-s)\\
=E[L(t-s)]
\end{gather}
\]</span></p>
<p><span class="math display">\[
\begin{gather}
Var[L(t)-L(s)]\\
=E[(L(t)-L(s)-E[L(t)-L(s)])^2]\\
=E[[L(t)-L(s)]^2-2[L(t)-L(s)]\mu(t-s)+\mu^2(t-s)^2]\\
=E[L^2(t)+L^2(s)-2L(t)L(s)]-\mu^2(t-s)^2\\
=\sigma^2t+\mu^2t^2+\sigma^2s+\mu^2s^2-\mu^2(t-s)^2-2E[L(t)L(s)]\\
=\sigma^2(t+s)+\mu^2(t^2+s^2-t^2-s^2+2ts)-2E[L(t)L(s)]\\
=\sigma^2(t+s)+2\mu^2ts-2E[L(t)L(s)]\\
=\sigma^2(t+s)+2\mu^2ts-2E[[L(s)+L(t)-L(s)]L(s)]
\end{gather}
\]</span></p>
<p>Since <span class="math inline">\(L(t)-L(s)\text{ is independent to }L(s)\)</span>, we have <span class="math display">\[
\begin{gather}
Var[L(t)-L(s)]\\
=\sigma^2(t+s)+2\mu^2ts-2[E[L^2(s)]+E[L(t)-L(s)]E[L(s)]]\\
=\sigma^2(t+s)+2\mu^2ts-2(\mu^2s^2+\sigma^2s+\mu(t-s)\mu s)\\
=\sigma^2(t+s)-2\sigma^2s\\
=\sigma^2(t-s)\\
=Var[L(t-s)]\
\end{gather}
\]</span> Hence <span class="math inline">\(L(t)-L(s)\)</span> has the same distribution of <span class="math inline">\(L(t-s)\)</span></p>
<h1 id="reference">Reference</h1>
<ol type="1">
<li><strong>Brockwell, P. J., &amp; Davis, R. A. (2002). <em>Introduction to time series and forecasting</em>. New York: Springer.</strong></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Weiru Han</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>
<script class="next-config" data-name="chatra" type="application/json">{"enable":true,"async":true,"id":"DWYLFGF8d2dgPGfdG"}</script>
<script src="/js/third-party/chat/chatra.js"></script>
<script async src="https://call.chatra.io/chatra.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdn.jsdelivr.net/npm/pdfobject@2.2.8/pdfobject.min.js","integrity":"sha256-tu9j5pBilBQrWSDePOOajCUdz6hWsid/lBNzK4KgEPM="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdn.jsdelivr.net/npm/mermaid@9.1.7/dist/mermaid.min.js","integrity":"sha256-G58AID1YoX5YaEtWfXSI0VLrZ6N4kvNvwg0BI8zUFxE="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>



  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
